# 系统管理（管理员功能）

## 通用

### 刷新缓存

刷新缓存的内容一共包含四个模块，刷新算子定义，刷新授权文件，重建搜索索引，刷新Demo数据；这四个模块对应系统在一些非常规操作下导致Web系统和Miner系统的数据未正常同步，一般是由系统管理员在后台对系统进行操作引起的，这种情况就需要用到这四个功能，以确保系统简单快速的恢复正常。

![JPG](..\..\img\2.jpg)

在点击相关操作之后，正常情况会出现刷新成功的弹框。四种操作，对应下图四个不同的弹窗提示。

![JPG](..\..\img\3.jpg)

## 用户管理

### 创建用户

系统账号需要有管理员账号统一分配，且具备一定的管理功能。管理员创建账号需要在【系统管理 –> 用户】操作界面中操作。

![JPG](..\..\img\4.jpg)

通过添加用户按钮启动用户添加流程。

![JPG](..\..\img\5.jpg)

弹框中的内容按说明填写完毕之后，点击创建，即可创建账号，直接将进入一些账号的初始化设置。

账号的初始化的内容包括，Kerberos权限设置，工作流Yarn任务队列设置。对于管理员来说，这些都是可选项；但是对于用户来说，如果这些设置不全面，一些高级功能将无法正常使用。其中，Kerberos权限设置也仅在系统开启了Kerberos权限认证的情况下才需要设置。

当系统开启了Kerberos认证，那么必须设置Kerberos的授权，即使管理员默认未配置，也需要用户后续设置此选项，否则此用户将无法使用工作流建模、Hive表导入等功能。

![JPG](..\..\img\6.jpg)

默认情况下，创建用户是系统会给将所有用户分配到默认的Yarn队列中去。如果有特殊系统，可以通过“[修改用户资料](https://www.xdatainsight.com/portal/%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3/ICM/V3.1%20%E6%93%8D%E4%BD%9C%E6%89%8B%E5%86%8C/ICM%20V3.1%20%E6%93%8D%E4%BD%9C%E6%89%8B%E5%86%8C.htm#_%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E8%B5%84%E6%96%99)”功能来更换Yarn队列。

### 修改用户资料

选中需要修改的用户，在系统页面的右侧栏可以看到【编辑】按钮，通过单击按钮开始修改此用户的资料。

编辑设置页一共分为几个模块，基础资料、安全设置、kerberos设置、资源设置；其中Kerberos设置仅系统启用Kerberos授权才需要设置。

基础资料设置包括用户的一些基本信息设置，例如用户名、电话号码、邮箱地址、性别、职位等信息，其中部分信息是可选的。

![JPG](..\..\img\7.jpg)

安全设置包括的是用户的密码信息设置。Kerberos设置是系统对此用户的Kerberos授权配置，包括凭证和秘钥keytab，详细内容请参考Hadoop大数据平台Kerberos授权相关内容。资源设置主要是控制用户在使用工作流功能时，可用的系统资源的限制，限制能力依赖Hadoop平台的Yarn提供的资源限制能力。

![JPG](..\..\img\8.jpg)

### 激活、取消激活

激活和取消激活功能是当业务需要的时候，关停某一个账号，但是不删除账号创建的数据。必要时还可以将账号重新激活继续使用。一旦关停账号，此账号就不可以登录，直到管理员激活此账号。管理员创建账号之后默认是激活状态，如果需要关停某个账号，仅需要选中之后，点击取消激活。激活账号操作同理，选中关停的账号，点击激活按钮即可。

![JPG](..\..\img\9.jpg)

![JPG](..\..\img\10.jpg)

## 日志

系统在用户使用过程中会产生很多活动记录，比如用户在某时刻创建了工作文件等等。日志功能使管理员可以下载一个时间段内的系统活动记录。

![JPG](..\..\img\11.jpg)

## 授权

### 系统授权信息

系统部署之后需要通过一个授权文件来对指定系统授权。授权内容包括系统的使用方信息，提供服务方信息，系统最大用户数，系统激活日期，系统过期日志，系统可使用的算子列表等信息。

![JPG](..\..\img\12.jpg)

### 更新系统授权

系统到期之前如果客户需要延期继续使用，需要更新授权以继续使用系统。为了方便起见，系统提供统一授权入口，简单的操作即可更新授权文件，以达到更新授权的功能。通过点击按钮“上传并更新授权”，选择授权文件以完成上传以更新授权文件。

![JPG](..\..\img\13.jpg)

## 扩展

扩展功能使用户可以在系统中开发实现自己的“算子”，我们称为“自定义算子”。在系统交付部署之后，会同时提供一套和系统版本匹配的用于开发自定义算的SDK；基于SDK开发算子，构建打包之后通过扩展功能集成到系统中。自定义算法的开发流程，方法此处不详细介绍，如果需要请参考自定义算法开发说明文档。

假设已经通过系统提供的SDK开发出了算子，通过打包流程构建出了算子Jar包。之后就可以通过此功能，将算子注册集成到系统中，注册之后算子将被系统内所有人可见，可用。

### 上传Jar包

通过系统页面上传开发的算子Jar包。

![JPG](..\..\img\14.jpg)

点击打开之后系统将上传Jar包到系统中。同样的针对已经上传的Jar包可以删除以取消此自定义算子。

![JPG](..\..\img\15.jpg)

### 注册算子

上传自定义Jar包之后，便可以将Jar包中包含的自定义算子注册系统算子列表中。注册算子需要填写算子名称，展示名称，算子类路径，启用状态。默认的自定义算子分组固定在“Custom Operators”分组内。

![JPG](..\..\img\16.jpg)

算子注册之后，可以通过修改编辑注册的算子内容，但是只可以修改算子的类路径和启用状态，算子名称以及展示名称不可修改。

![JPG](..\..\img\17.jpg)

同样的算子注册之后还可以删除以取消算子注册。

![JPG](..\..\img\18.jpg)

##   系统文件

系统依赖Hadoop集群系统，默认会使用Hadoop提供的HDFS保存一些系统文件。如果中期需要作出一些特殊更新，比如算子包更新，或者其他内容更新需要更新HDFS中存储的系统文件时，便可使用此功能替换相应的系统文件，已达到更新的目的。

默认的一进入“系统文件”模块将看到HDFS根目录文件结构，在权限不足的情况下，根目录不可预览，次数需要手动输入可用的系统文件路径，以展示文件结构。

![JPG](..\..\img\19.jpg)

进入指定目录之后可以通过上传数据上传数据到此目录，如果文件同名此文件将被覆盖。需要注意的是此模块不提供文件下载或预览的功能。

![JPG](..\..\img\20.jpg)